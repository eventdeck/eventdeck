<div>
  <h2 ng-show="loading">Loading...</h2>
  <div id="scroll-chat" class="all-100" ng-hide="loading" scroll-glue>
    <div infinite-scroll="history()" infinite-scroll-distance="1" infinite-scroll-reverse="true" infinite-scroll-container="'#scroll-chat'" infinite-scroll-parent="true">
      <div class="infinite-scroll">
        <div ng-repeat="message in messages | orderBy:'date':false" class="all-100 chat-message">

          <div ng-if="message.kind == 'message'">
            <div>
              <a href="#/member/{{message.member}}" title="{{getMember(message.member).name}}">
                <img ng-src="https://graph.facebook.com/{{getMember(message.member).facebook}}/picture" style="width:25px"/>
              </a>
              <small title="{{timeSince(message.date)}}" ng-bind-html="message.text | linky:'_blank'"></small>
            </div>
          </div>

          <div ng-if="message.kind == 'notification'">
            <div>
              <a href="#/member/{{message.member}}" title="{{getMember(message.member).name}}">
                <img ng-src="https://graph.facebook.com/{{getMember(message.member).facebook}}/picture" style="width:25px"/>
              </a>
              <a href="#/{{message.source.replace('-','/')}}">
                <small title="{{timeSince(message.date)}}">{{message.text}} <small>{{timeSince(message.date)}}</small></small>
              </a>
            </div>
            <topic-card ng-if="message.source.indexOf('topic') !== -1" topic="getTopic(message.source.replace('topic-', ''))" members="members" me="me" roles="roles" tags="topicTags" comments="comments" notifications="unreadNotifications"></topic-card>
            <speaker-card  event="currentEvent" ng-if="currentEvent.name && message.source.indexOf('speaker')!=-1" speaker="getSpeaker(message.source.replace('speaker-',''))" members="members" me="me" notifications="unreadNotifications"></speaker-card>
            <company-card  event="currentEvent" ng-if="currentEvent.name && message.source.indexOf('company')!=-1" company="getCompany(message.source.replace('company-',''))" members="members" me="me" notifications="unreadNotifications"></company-card>
            <embed-meeting ng-if="message.source.indexOf('meeting-') != -1" meeting-id="message.source.replace('meeting-', '')" members="members"></embed-meeting>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="awesome-sidebar hide-medium hide-small hide-tiny" title="Click to hide sidebar!" ng-hide="hideSidebar || loading" style="padding-bottom:120px;">
    <div class="header">
      <b title="Click to hide sidebar!">#{{chat.id}}</b>
      <div ng-click="hideSidebar=!hideSidebar" class="push-right hide-button">HIDE</div>
    </div>

    <h6><a href="#/chat/{{subchat.id}}/" ng-show="subchat.id!=chat.id" ng-repeat="subchat in chats | orderBy:'name':true">
      #{{subchat.id}}
    </a></h6>

    <div ng-repeat="user in online | orderBy:['-on', 'name']" style="margin-bottom:10px;">
      <a href="#/member/{{user.member}}">
        <img ng-src="https://graph.facebook.com/{{getMember(user.member).facebook}}/picture" style="width:25px;"/>
        <small>{{getMember(user.member).name}}</small>
      </a>
      <small ng-if="user.on" style="font-size:xx-small; color: LimeGreen">Online</small>
    </div>
  </div>

  <div class="awesome-sidebar-button" ng-click="hideSidebar=!hideSidebar" title="Click to show sidebar!" ng-show="hideSidebar">
    <i class="fa fa-3x fa-caret-left"></i>
  </div>

  <div class="awesome-bottombar" ng-hide="loading">
    <form class="ink-form" ng-submit="submit()">
      <div class="control-group">
        <input ng-model="text" type="text" id="submit" placeholder="Say something chatty!" style="width: 100%;">
      </div>
    </form>
  </div>
</div>
