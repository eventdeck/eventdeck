<h2 ng-show="loading">Loading...</h2>
<div ng-hide="loading">
  <h1>Chat {{chat.name}}</h1>
</div>
<div scroll-glue ng-hide="loading" style="position: absolute; top: 100px; left: 20px; overflow-y: scroll; height: 70%; width:70%; background:white">
 <ul class="unstyled">
    <li ng-repeat="message in messages | orderBy:'date':false" infinite-scroll="history()" infinite-scroll-reverse="true">
      <div ng-if="message.kind == 'message'">
        <div ng-show="message.member == me.id" class="chat-message me">
          <small title="{{timeSince(message.date)}}" ng-bind-html="message.text | linky:'_blank'"></small>
          <a href="/#/member/{{message.member}}" title="{{getMember(message.member).name}}">
            <img ng-src="https://graph.facebook.com/{{getMember(message.member).facebook}}/picture" style="width:25px"/>
          </a>
        </div>
        <div ng-show="message.member != me.id" class="chat-message others">
          <a href="/#/member/{{message.member}}" title="{{getMember(message.member).name}}">
            <img ng-src="https://graph.facebook.com/{{getMember(message.member).facebook}}/picture" style="width:25px"/>
          </a>
          <small title="{{timeSince(message.date)}}" ng-bind-html="message.text | linky:'_blank'"></small>
        </div>
      </div>
      <div ng-if="message.kind == 'notification'">
        <blockquote>
          <a href="/#/{{message.source}}" title="{{timeSince(message.date)}}">
            {{message.text}}
          </a>
          <a href="/#/member/{{message.member}}" title="{{getMember(message.member).name}}">
            <img src="https://graph.facebook.com/{{getMember(message.member).facebook}}/picture" style="width:25px; margin-left:15px;"/>
          </a>
          <div ng-show="message.member == me.id" class="chat-notification me">
            <small title="{{timeSince(message.date)}}">{{message.text}}</small>
            <a href="/#/member/{{message.member}}" title="{{getMember(message.member).name}}">
              <img ng-src="https://graph.facebook.com/{{getMember(message.member).facebook}}/picture" style="width:25px"/>
            </a>
          </div>
          <div ng-show="message.member != me.id" class="chat-notification others">
            <a href="/#/member/{{message.member}}" title="{{getMember(message.member).name}}">
              <img ng-src="https://graph.facebook.com/{{getMember(message.member).facebook}}/picture" style="width:25px"/>
            </a>
            <small title="{{timeSince(message.date)}}">{{message.text}}</small>
          </div>
        </blockquote>
      </div>
    </li>
  </ul>
</div>

<div ng-hide="loading" style="position: absolute; top: 50px; right: 20px; overflow-y: scroll; height: 90%; width:25%">
  <div ng-repeat="user in online | orderBy:['-on', 'name']" style="margin-bottom:10px">
    <div class="column-group horizontal-gutters">
      <div class="all-20">
        <a href="/#/member/{{user.member}}"><img ng-src="https://graph.facebook.com/{{getMember(user.member).facebook}}/picture" style="width:25px; margin-left:15px;"/></a>
      </div>
      <div class="all-60">
        <small>{{getMember(user.member).name}}</small>
      </div>
      <div class="all-20" ng-if="user.on">
        <small style="font-size:xx-small; color: LimeGreen">Â· Online</small>
      </div>
    </div>
  </div>
</div>

<div ng-hide="loading" style="position: absolute; bottom: 0; right: 30%;width: 30%; overflow-y: scroll;">
  <form class="ink-form" ng-submit="submit()">
    <div class="control-group">
      <input ng-model="text" type="text" id="submit" placeholder="Say something chatty!" style="width: 100%;">
    </div>
  </form>
</div>
